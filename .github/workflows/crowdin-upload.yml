# Manual workflow to upload source files to Crowdin
name: Upload Sources to Crowdin

on:
  workflow_dispatch: # Manual trigger only

permissions:
  contents: read

jobs:
  upload:
    name: Upload Source Files
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v5

      - name: Setup environment
        uses: ./.github/actions/setup
        with:
          mariadb_tag: latest
          wordpress_tag: latest
          node_tag: 22
          plugin_name: ${{ github.event.repository.name }}
          github_token: ${{ secrets.GITHUB_TOKEN }}

      - name: Upload sources to Crowdin
        run: make crowdin-upload
        env:
          CROWDIN_PROJECT_ID: ${{ secrets.CROWDIN_PROJECT_ID }}
          CROWDIN_PERSONAL_TOKEN: ${{ secrets.CROWDIN_PERSONAL_TOKEN }}

      - name: Shutdown environment
        uses: ./.github/actions/shutdown
        with:
          cleanup_mode: basic
